{% extends "webapp/header.html" %}

{% block transcript %}

{% load static %}

	<div class = "container topElement">
		<div class="row">
			<div class="col text-center">
				<button type="button" class="btn btn-secondary">Upload Audio File</button>
			</div>
			<div class="col text-center">
				<a href="#" id="saveButton" class="btn btn-secondary" download="transcript.txt">Save Text</a>
			</div>
			<div class="col text-center">
				<a id="analysisBtn" href="#" class="btn btn-secondary">Go to Analysis</a>
			</div>
		</div>
	</div>

	<div class="container scroll">
		<div class="card">
			<div class="card-body">
				<div style="border:1px solid #ccc;font:16px/26px Georgia, Garamond, Serif;overflow:auto;">
					<p id="scriptText">
						<div class="ajaxProgress">
							<h3>Please Wait...</h3>
							<img src= "{% static 'webapp/img/ajax-loader.gif' %}"/>
						</div>
						{{value}}
						<!-- {{data}} -->

						<!-- {% for key,value in data.items %}
							<script type="text/javascript"> 
							   var text = "{{value}}";
							</script>
							{{value}}
						{% endfor %} -->
					</p>
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		$(document).ready(function() {
			$('.ajaxProgress').show();
			var fileName = "{{fileName}}";
			$.ajax({
				type: "GET",
				url: "http://localhost:8000/transcript_backend/" + fileName,
				dataType: "html",
				async: true,
				success: function(html) {
					$("#scriptText").html(html);
					$('.ajaxProgress').hide();
				}
			})
 		});
		
		var fileName = "{{fileName}}";
		var analysisFile = fileName.replace(".wav", ".json");
		var transcriptFile = fileName.replace(".wav", ".txt");

		document.getElementById("analysisBtn").href="http://localhost:8000/analysis/" + analysisFile;
		document.getElementById("saveButton").href="https://s3-us-west-2.amazonaws.com/test-speechcapture/" + transcriptFile; 
		 
	
	</script>

{% endblock %}